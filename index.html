<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mini Taxi Boss (HTML Only)</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #111;
    color: #fff;
    font-family: Arial, sans-serif;
    overflow: hidden;
  }

  #ui {
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 10;
    font-size: 14px;
    background: rgba(0,0,0,0.5);
    padding: 8px 10px;
    border-radius: 6px;
  }

  #ui span {
    display: inline-block;
    margin-right: 10px;
  }

  #help {
    margin-top: 4px;
    font-size: 12px;
    opacity: 0.8;
  }

  canvas {
    display: block;
    background: #1b1b1b;
  }
</style>
</head>
<body>
<div id="ui">
  <div>
    <span>ðŸ’° Cash: <span id="cash">0</span></span>
    <span>ðŸš• Fare: <span id="fare">0</span></span>
    <span>ðŸŽ¯ Job: <span id="jobStatus">None</span></span>
  </div>
  <div id="help">
    Controls: W/A/S/D or Arrow Keys to drive.  
    Drive over a green passenger to pick up, then to the red marker to drop off.
  </div>
</div>
<canvas id="game"></canvas>

<script>
(function() {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resize);
  resize();

  // UI elements
  const cashEl = document.getElementById('cash');
  const fareEl = document.getElementById('fare');
  const jobStatusEl = document.getElementById('jobStatus');

  // World settings
  const world = {
    width: 2000,
    height: 2000
  };

  // Camera
  const camera = {
    x: 0,
    y: 0
  };

  // Taxi
  const taxi = {
    x: world.width / 2,
    y: world.height / 2,
    w: 40,
    h: 20,
    angle: 0,
    speed: 0,
    maxSpeed: 4,
    accel: 0.15,
    friction: 0.05,
    turnSpeed: 0.06
  };

  // Player stats
  let cash = 0;
  let currentFare = 0;

  // Job system
  let passenger = null;
  let destination = null;
  let hasPassenger = false;

  // Input
  const keys = {};
  window.addEventListener('keydown', e => {
    keys[e.key.toLowerCase()] = true;
  });
  window.addEventListener('keyup', e => {
    keys[e.key.toLowerCase()] = false;
  });

  function rand(min, max) {
    return Math.random() * (max - min) + min;
  }

  // Generate simple "city" blocks (just rectangles as buildings)
  const buildings = [];
  for (let i = 0; i < 60; i++) {
    const bw = rand(80, 200);
    const bh = rand(80, 200);
    const bx = rand(0, world.width - bw);
    const by = rand(0, world.height - bh);
    buildings.push({ x: bx, y: by, w: bw, h: bh });
  }

  function createPassenger() {
    passenger = {
      x: rand(100, world.width - 100),
      y: rand(100, world.height - 100),
      r: 14
    };
    destination = null;
    hasPassenger = false;
    currentFare = 0;
    updateUI();
  }

  function createDestination() {
    destination = {
      x: rand(100, world.width - 100),
      y: rand(100, world.height - 100),
      r: 18
    };
    currentFare = Math.floor(rand(50, 200));
    hasPassenger = true;
    updateUI();
  }

  function updateUI() {
    cashEl.textContent = cash;
    fareEl.textContent = currentFare;
    if (!passenger && !destination) {
      jobStatusEl.textContent = 'None';
    } else if (passenger && !hasPassenger) {
      jobStatusEl.textContent = 'Pick up passenger';
    } else if (hasPassenger && destination) {
      jobStatusEl.textContent = 'Drive to destination';
    }
  }

  createPassenger();

  function updateTaxi() {
    const up = keys['w'] || keys['arrowup'];
    const down = keys['s'] || keys['arrowdown'];
    const left = keys['a'] || keys['arrowleft'];
    const right = keys['d'] || keys['arrowright'];

    if (up) {
      taxi.speed += taxi.accel;
    } else if (down) {
      taxi.speed -= taxi.accel;
    } else {
      if (taxi.speed > 0) taxi.speed -= taxi.friction;
      else if (taxi.speed < 0) taxi.speed += taxi.friction;
      if (Math.abs(taxi.speed) < 0.02) taxi.speed = 0;
    }

    if (taxi.speed > taxi.maxSpeed) taxi.speed = taxi.maxSpeed;
    if (taxi.speed < -taxi.maxSpeed * 0.6) taxi.speed = -taxi.maxSpeed * 0.6;

    if (taxi.speed !== 0) {
      const dir = taxi.speed > 0 ? 1 : -1;
      if (left) taxi.angle -= taxi.turnSpeed * dir;
      if (right) taxi.angle += taxi.turnSpeed * dir;
    }

    taxi.x += Math.cos(taxi.angle) * taxi.speed;
    taxi.y += Math.sin(taxi.angle) * taxi.speed;

    // Keep taxi in world bounds
    taxi.x = Math.max(0, Math.min(world.width, taxi.x));
    taxi.y = Math.max(0, Math.min(world.height, taxi.y));
  }

  function distance(a, b) {
    const dx = a.x - b.x;
    const dy = a.y - b.y;
    return Math.sqrt(dx * dx + dy * dy);
  }

  function updateJobs() {
    if (passenger && !hasPassenger) {
      if (distance(taxi, passenger) < 30) {
        createDestination();
        passenger = null;
      }
    } else if (hasPassenger && destination) {
      if (distance(taxi, destination) < 35) {
        cash += currentFare;
        passenger = null;
        destination = null;
        hasPassenger = false;
        currentFare = 0;
        updateUI();
        setTimeout(createPassenger, 600);
      }
    }
  }

  function updateCamera() {
    camera.x = taxi.x - canvas.width / 2;
    camera.y = taxi.y - canvas.height / 2;

    camera.x = Math.max(0, Math.min(world.width - canvas.width, camera.x));
    camera.y = Math.max(0, Math.min(world.height - canvas.height, camera.y));
  }

  function drawWorld() {
    ctx.fillStyle = '#202020';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Roads grid
    ctx.strokeStyle = '#2c2c2c';
    ctx.lineWidth = 2;
    const gridSize = 120;
    for (let x = 0; x < world.width; x += gridSize) {
      const sx = x - camera.x;
      ctx.beginPath();
      ctx.moveTo(sx, -camera.y);
      ctx.lineTo(sx, world.height - camera.y);
      ctx.stroke();
    }
    for (let y = 0; y < world.height; y += gridSize) {
      const sy = y - camera.y;
      ctx.beginPath();
      ctx.moveTo(-camera.x, sy);
      ctx.lineTo(world.width - camera.x, sy);
      ctx.stroke();
    }

    // Buildings
    ctx.fillStyle = '#333';
    buildings.forEach(b => {
      const sx = b.x - camera.x;
      const sy = b.y - camera.y;
      if (sx + b.w < 0 || sy + b.h < 0 || sx > canvas.width || sy > canvas.height) return;
      ctx.fillRect(sx, sy, b.w, b.h);
    });
  }

  function drawPassengerAndDestination() {
    if (passenger) {
      const sx = passenger.x - camera.x;
      const sy = passenger.y - camera.y;
      ctx.fillStyle = '#3cff3c';
      ctx.beginPath();
      ctx.arc(sx, sy, passenger.r, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = '#0b0';
      ctx.font = '12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('PASSENGER', sx, sy - 18);
    }

    if (destination) {
      const sx = destination.x - camera.x;
      const sy = destination.y - camera.y;
      ctx.fillStyle = '#ff3c3c';
      ctx.beginPath();
      ctx.arc(sx, sy, destination.r, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = '#b00';
      ctx.font = '12px Arial';
      ctx.textAlign = 'center';
      ctx.fillText('DESTINATION', sx, sy - 18);
    }
  }

  function drawTaxi() {
    const sx = taxi.x - camera.x;
    const sy = taxi.y - camera.y;

    ctx.save();
    ctx.translate(sx, sy);
    ctx.rotate(taxi.angle);

    // Body
    ctx.fillStyle = '#ffd800';
    ctx.fillRect(-taxi.w / 2, -taxi.h / 2, taxi.w, taxi.h);

    // Roof
    ctx.fillStyle = '#fff';
    ctx.fillRect(-taxi.w / 4, -taxi.h / 2 + 2, taxi.w / 2, taxi.h / 2);

    // "TAXI" sign
    ctx.fillStyle = '#000';
    ctx.font = '8px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('TAXI', 0, -2);

    ctx.restore();
  }

  function drawMinimap() {
    const mapSize = 160;
    const padding = 10;
    const x = canvas.width - mapSize - padding;
    const y = canvas.height - mapSize - padding;

    ctx.save();
    ctx.globalAlpha = 0.8;
    ctx.fillStyle = '#000';
    ctx.fillRect(x, y, mapSize, mapSize);

    ctx.strokeStyle = '#555';
    ctx.strokeRect(x, y, mapSize, mapSize);

    const scaleX = mapSize / world.width;
    const scaleY = mapSize / world.height;

    // Buildings (tiny dots)
    ctx.fillStyle = '#444';
    buildings.forEach(b => {
      const bx = x + b.x * scaleX;
      const by = y + b.y * scaleY;
      ctx.fillRect(bx, by, Math.max(1, b.w * scaleX), Math.max(1, b.h * scaleY));
    });

    // Passenger
    if (passenger) {
      ctx.fillStyle = '#3cff3c';
      const px = x + passenger.x * scaleX;
      const py = y + passenger.y * scaleY;
      ctx.beginPath();
      ctx.arc(px, py, 3, 0, Math.PI * 2);
      ctx.fill();
    }

    // Destination
    if (destination) {
      ctx.fillStyle = '#ff3c3c';
      const dx = x + destination.x * scaleX;
      const dy = y + destination.y * scaleY;
      ctx.beginPath();
      ctx.arc(dx, dy, 3, 0, Math.PI * 2);
      ctx.fill();
    }

    // Taxi
    ctx.fillStyle = '#ffd800';
    const tx = x + taxi.x * scaleX;
    const ty = y + taxi.y * scaleY;
    ctx.beginPath();
    ctx.arc(tx, ty, 4, 0, Math.PI * 2);
    ctx.fill();

    ctx.restore();
  }

  function loop() {
    updateTaxi();
    updateJobs();
    updateCamera();

    drawWorld();
    drawPassengerAndDestination();
    drawTaxi();
    drawMinimap();

    requestAnimationFrame(loop);
  }

  loop();
})();
</script>
</body>
</html>
